# Cloudflare Pages Deployment - Step by Step

## ğŸ¯ Why Cloudflare?
- âœ… **Unlimited bandwidth** (vs 100GB on Vercel)
- âœ… **Unlimited requests** (vs 1M on Vercel)
- âœ… **Unlimited API calls** (no function invocation limits!)
- âœ… **200+ edge locations**
- âœ… **Free tier is genuinely free at scale**

---

## ğŸš€ Option 1: Deploy via CLI (Fastest)

```bash
# Build for Cloudflare
npm run build:cloudflare

# Deploy (first time)
npx wrangler pages deploy .vercel/output/static --project-name=bellum

# Future deploys
npm run deploy:cloudflare
```

---

## ğŸ”— Option 2: Auto-Deploy via Git (Recommended)

### Step 1: Connect Repository

1. Go to [dash.cloudflare.com](https://dash.cloudflare.com/)
2. Click **Pages** in the left sidebar
3. Click **Create a project**
4. Choose **Connect to Git**
5. Select your **bellum** repository
6. Click **Begin setup**

### Step 2: Configure Build Settings

**Framework preset:** Next.js

**Build settings:**
```
Build command:       npm run build:cloudflare
Build output:        .vercel/output/static
Root directory:      /
Node version:        22
```

**Environment variables:**
```
NODE_VERSION=22
NEXT_PUBLIC_PLATFORM=cloudflare
```

### Step 3: Deploy!

Click **Save and Deploy**

Your site will be live at: `https://bellum-xxx.pages.dev`

---

## ğŸŒ Custom Domain Setup

### Step 1: Add Domain in Cloudflare

1. In Pages project â†’ **Custom domains**
2. Click **Set up a custom domain**
3. Enter: `challengerdeep.com` (or your domain)
4. Click **Continue**

### Step 2: Update DNS

Cloudflare will auto-configure DNS if your domain is on Cloudflare.

**If domain is elsewhere:**
- Add CNAME: `bellum-xxx.pages.dev`
- Or add A records to Cloudflare's IPs

### Step 3: Wait for SSL

SSL certificate provisions automatically (~5 minutes).

---

## âš™ï¸ Build Optimization

Your app is already optimized:
- âœ… All 53 API routes use Edge runtime
- âœ… `--skip-validation` flag enabled
- âœ… `.cfpagesignore` excludes unnecessary files
- âœ… Build time: ~2 minutes

---

## ğŸ”„ Deployment Workflow

**Automatic (Git-based):**
```bash
git add .
git commit -m "Update feature"
git push origin main
# Cloudflare auto-deploys in ~2 minutes
```

**Manual (CLI):**
```bash
npm run deploy:cloudflare
```

---

## ğŸ“Š Monitor Your Deployment

**Build logs:**
- Pages â†’ Your project â†’ Deployments
- Click on the latest deployment
- View build logs in real-time

**Analytics:**
- Pages â†’ Your project â†’ Analytics
- View requests, bandwidth, errors

---

## ğŸ› Troubleshooting

### Build fails with "Routes not configured for Edge runtime"
âœ… Already fixed! All routes are Edge-compatible.

### "Hello World" appears
- Check build output: Should see `_worker.js`
- Verify build command: `npm run build:cloudflare`
- Check logs for errors

### Build timeout
- Contact Cloudflare support to increase timeout
- Or optimize build (already done)

### Domain not working
- Wait 5-10 minutes for DNS propagation
- Check SSL certificate status
- Verify CNAME points to `*.pages.dev`

---

## ğŸ’° Cost Comparison

### Cloudflare Pages (Your New Primary)
- **Bandwidth:** UNLIMITED âœ¨
- **Requests:** UNLIMITED âœ¨
- **Builds:** 500/month
- **Cost:** $0/month

### Vercel (Keep as Backup)
- **Bandwidth:** 100GB/month
- **Requests:** 1M/month
- **Builds:** Unlimited
- **Cost:** $0/month (until limits)

**Savings:** Effectively unlimited vs. $20-200/month on Vercel Pro/Enterprise

---

## ğŸ‰ You're Ready!

Push your code or run:
```bash
npm run deploy:cloudflare
```

Your API requests are now **unlimited**! ğŸš€
